<!DOCTYPE html>
<!--
    Copyright 2021 James Deery
    Released under the MIT licence, https://opensource.org/licenses/MIT
 -->
<html>
<head>
    <title>M8 Display</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" type="image/png" href="icon.png">
    <link rel="manifest" href="app.webmanifest">
    <link rel="stylesheet" href="build/index.css">
</head>
<body>
    <div id="display">
        <canvas id="canvas" width="320" height="240"></canvas>

        <div id="buttons" class="hidden"></div>

        <div id="mapping-buttons"></div>

        <div id="mapping-help">
            <p class="select-action">Click a key to add a new mapping</p>
            <p class="enter-input">Press a keyboard key or gamepad button</p>
        </div>

        <div id="controls">
            <div data-action="edit" style="top: 2.0833%; left: 76.5625%"></div>
            <div data-action="option" style="top: 2.0833%; left: 53.125%"></div>
            <div data-action="up" style="top: 6.25%; left: 25%"></div>
            <div data-action="left" style="top: 37.5%; left: 1.5625%"></div>
            <div data-action="down" style="top: 37.5%; left: 25%"></div>
            <div data-action="right" style="top: 37.5%; left: 48.4375%"></div>
            <div data-action="select" style="top: 70.8333%; left: 27.3438%"></div>
            <div data-action="start" style="top: 70.8333%; left: 50.7813%"></div>
        </div>
    </div>

    <div id="serial-fail" class="error hidden">
        <p>Failed to connect over Serial.
        Are you sure your Teensy is connected and the M8 Headless firmware is loaded?</p>
        <p>Make sure that there are no other programs running which may have the serial port open.</p>
        <p>On Linux you may also need make sure you have permission to open the serial port (eg. make yourself a member of the <code>dialout</code> group).</p>
        <p>It is also possible there's a bug in this code.
        There may be some messages in the developer console that will help with debugging.</a>
    </div>
    <div id="usb-fail" class="error hidden">
        <p>Failed to connect with WebUSB.
        Are you sure your Teensy is connected and the M8 Headless firmware is loaded?</p>
        <p>Connecting with WebUSB is known not to work on Windows or Linux.
        If you are using Chrome you can use Serial instead but you need to enable an experimental flag by going to <code>chrome://flags</code> and enabling "Experimental Web Platform features".</p>
    </div>
    <div id="no-serial-usb" class="error hidden">
        <p>Your browser doesn't appear to have Serial or WebUSB support.
        These are only currently supported in Chrome and some Chrome-derived browsers.</p>
    </div>

    <div id="settings" class="hidden">
        <button id="menu-button">Menu</button>
    </div>

    <div id="info">
        Work in progress, use at your own risk.
        More details at <a href="https://github.com/derkyjadex/M8WebDisplay">https://github.com/derkyjadex/M8WebDisplay</a>.
    </div>

    <div id="reload" class="hidden">
        <button>An update is available. Click to reload.</button>
    </div>

    <div id="capture-shield"></div>

    <div id="firmware" class="hidden">
        <input id="firmware-file" type="file" accept=".hex">
        <button id="firmware-flash">Flash</button>
        <progress id="firmware-progress">
    </div>

    <script type="module" src="main.js"></script>
</body>
</html>
